{"id":24301,"name":"Bulk File Stream Part 2 JSON","description":"This Formula will stream the generated bulk file to a destination. Create an Element Instance to retrieve the records from and an Element Instance to accept the file like S3, Dropbox, etc. Enter in an object name (i.e. contacts) when creating the Formula Instance. This can also be a VDR name like myContacts. This is for JSON files uploads.","userId":5426,"accountId":5337,"createdDate":"2019-02-22T22:38:57Z","steps":[{"id":145527,"onSuccess":["path"],"onFailure":[],"name":"filterCompleted","type":"filter","properties":{"body":"//trigger.args is the body that is sent from the bulk file after it is finished being generated\nlet body = trigger.args;\n\nif(body.recordsCount > 0 && body.status == \"COMPLETED\"){\n done(true); \n  \n}\ndone(false);"}},{"id":145530,"onSuccess":["streamBulkFile"],"onFailure":[],"name":"metadata","type":"script","properties":{"body":"done({\"data\":{\"uploadFormData\" : {\"format\":\"json\"}},\n     \"name\":{\"uploadFormDataName\":\"metaData\"}});"}},{"id":145528,"onSuccess":["metadata"],"onFailure":[],"name":"path","type":"script","properties":{"body":"//enter the correct path here of the file after it has streamed to its destination\ndone({\"path\":\"/mynewfile.json\"});"}},{"id":145529,"onSuccess":[],"onFailure":[],"name":"streamBulkFile","type":"elementRequestStream","properties":{"downloadMethod":"GET","uploadFormData":"${steps.metadata.data}","uploadFormDataName":"${steps.metadata.name}","uploadQuery":"${steps.path}","uploadElementInstanceId":"${config.destination}","uploadApi":"/files","uploadMethod":"POST","downloadApi":"/bulk/${trigger.args.id}/${config.objectname}","downloadElementInstanceId":"${config.source}"}}],"triggers":[{"id":21756,"onSuccess":["filterCompleted"],"onFailure":[],"type":"manual","async":true,"name":"trigger","properties":{}}],"active":true,"singleThreaded":false,"debugLoggingEnabled":true,"configuration":[{"id":41624,"key":"destination","name":"destination","type":"elementInstance","required":true},{"id":41625,"key":"objectname","name":"object name","type":"value","required":true},{"id":41626,"key":"source","name":"source","type":"elementInstance","required":true}]}