{"id":24299,"name":"Bulk File Generation Part 1 - Manual Trigger","description":"This Formula will generate a bulk file. Create an Element Instance to retrieve the records from. Enter in an object name (i.e. contacts). This can also be a VDR name like myContacts. Enter in the Part 2 Formula Instance Id as well.","userId":5426,"accountId":5337,"createdDate":"2019-02-22T21:55:11Z","steps":[{"id":145513,"onSuccess":["generateBulkFile"],"onFailure":[],"name":"bulkHeader","type":"script","properties":{"body":"//This is the call to the formula instance that will pull the file and stream it somewhere (part 2) - this uses the value of the id provided for this formula instance \n\n\ndone({'Elements-Async-Callback-Url':'/formulas/instances/'+config.parttwoinstanceid+'/executions'});"}},{"id":145514,"onSuccess":["bulkHeader"],"onFailure":[],"name":"bulkQuery","type":"script","properties":{"body":"//This uses the value provided when creating a Formula instance for the object name. It can be a VDR name like myContacts or a standard resource name like contacts\n\ndone({\"q\":\"select * from \"+config.objectname})"}},{"id":145515,"onSuccess":["objectArray"],"onFailure":[],"name":"endDate","type":"script","properties":{"body":"var end = new Date().toISOString();\ndone({\"end\":end});"}},{"id":145516,"onSuccess":["bulkHeader"],"onFailure":[],"name":"findCorrectId","type":"script","properties":{"body":"var arr = steps.getInstanceId.response.body;\n\nfor(var i=0; i<arr.length; i++){\n  \n  \n  \n}"}},{"id":145517,"onSuccess":[],"onFailure":[],"name":"generateBulkFile","type":"elementRequest","properties":{"method":"POST","query":"${steps.bulkQuery}","headers":"${steps.bulkHeader}","api":"/bulk/query","elementInstanceId":"${config.source}"}},{"id":145518,"onSuccess":["endDate"],"onFailure":[],"name":"getInstanceId","type":"request","properties":{"method":"GET","api":"/formulas/instances"}},{"id":145519,"onSuccess":["bulkQuery"],"onFailure":["putBody"],"name":"loopObjects","type":"loop","properties":{"list":"steps.objectArray.objects"}},{"id":145520,"onSuccess":["loopObjects"],"onFailure":[],"name":"objectArray","type":"script","properties":{"body":"var objectName = config.objectName;\n//var objectsArr = JSON.parse(objectName);\n\ndone({\"objects\":objectName});"}},{"id":145521,"onSuccess":["putTime"],"onFailure":[],"name":"putBody","type":"script","properties":{"body":"done({\"active\" : true,\n      \"configuration\": {\n        \"start\": steps.bulkQuery.to,\n        \"source\": config.source,\n        \"filter\":config.filter,\n        \"objectName\":JSON.stringify(config.objectName)\n      },\n      \"name\":info.formulaInstanceName});"}},{"id":145522,"onSuccess":[],"onFailure":[],"name":"putTime","type":"elementRequest","properties":{"method":"PUT","api":"/formulas/${info.formulaId}/instances/${info.formulaInstanceId}","body":"steps.putBody","elementInstanceId":"${config.source}"}}],"triggers":[{"id":21754,"onSuccess":["bulkQuery"],"onFailure":[],"type":"manual","async":true,"name":"trigger","properties":{}}],"active":true,"singleThreaded":false,"debugLoggingEnabled":true,"configuration":[{"id":41614,"key":"filter","name":"filter","type":"value","required":true},{"id":41621,"key":"objectname","name":"object name","type":"value","required":true},{"id":41615,"key":"objectName","name":"objectName","type":"value","required":true},{"id":41622,"key":"parttwoinstanceid","name":"part two instance id","type":"value","required":true},{"id":41616,"key":"source","name":"source","type":"elementInstance","required":true},{"id":41617,"key":"start","name":"start","type":"value","required":true}]}